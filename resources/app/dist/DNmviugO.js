import{d as ae,d2 as Ie,d3 as ye,r as E,t as V,v as N,z as e,A as t,N as l,bd as He,B as s,ax as Ce,R as H,Q as G,L as A,y as F,ab as se,a4 as ie,X as re,Y as ue,Z as de,af as ce,a1 as fe,a2 as we,aa as We,ac as pe,W as _e,aH as me,ar as Oe,_ as ge,aK as Te,aL as Ve,bj as K,c as qe,d4 as be,K as Qe,ao as Ke,e as ke,bp as Xe,P as le,x as X,d5 as Ye,bk as Ze,m as xe,aN as z,bo as Ge,o as Je,bm as et,M as tt,O as oe,ai as nt,V as ot,ap as lt,aj as at,aW as st,a3 as it,au as rt,a0 as ut,a6 as dt,a8 as ct,a9 as ft,d6 as pt,ba as _t,d7 as mt,d8 as gt,ay as vt,an as ht,d9 as bt,da as St,C as It,D as yt,db as Ct,at as wt}from"./0fV2q4Ox.js";import{_ as Ot}from"./logout.js";import{b as Tt}from"./C9eiVLGd.js";import{f as Vt}from"./BJaqhUnt.js";import{a as kt}from"./M_3S_cE4.js";import{n as xt,a as Lt,o as Se}from"./D0r5xylr.js";import"./BYx_WZxC.js";const $t=ae({__name:"monitorSettingsButton",setup(w){const c=Ie(),p=ye();let u={...c.value},o={...p.value};const r=E(!1),d=h=>{h&&(u={...c.value},o={...p.value}),r.value=h},I=()=>{c.value={...u},p.value={...o},d(!1)};return(h,_)=>{const O=se,y=ie,T=re,$=ue,R=de,m=ce,L=fe,x=we,D=We,S=pe,k=_e,M=me,B=Oe;return V(),N(H,null,[e(y,{color:"light",onClick:_[0]||(_[0]=f=>d(!0))},{default:t(()=>[e(O,{color:"medium",icon:"ioniconsSettingsSharp"in h?h.ioniconsSettingsSharp:l(He)},null,8,["icon"])]),_:1}),e(B,{"is-open":l(r),onWillDismiss:_[14]||(_[14]=f=>d(!1))},{default:t(()=>[e(R,null,{default:t(()=>[e($,null,{default:t(()=>[e(T,null,{default:t(()=>[s("Settings")]),_:1}),e(y,{onClick:_[1]||(_[1]=f=>d(!1)),slot:"end",fill:"default"},{default:t(()=>[e(O,{icon:"ioniconsClose"in h?h.ioniconsClose:l(Ce),size:"medium"},null,8,["icon"])]),_:1})]),_:1})]),_:1}),e(S,{class:"ion-padding"},{default:t(()=>[e(T,{class:"monitor-setting-title"},{default:t(()=>[s("Serial Connection")]),_:1}),e(x,null,{default:t(()=>[e(L,{label:"Baud Rate",modelValue:l(u).baudRate,"onUpdate:modelValue":_[2]||(_[2]=f=>l(u).baudRate=f),placeholder:"115200 (default)",interface:"popover"},{default:t(()=>[(V(!0),N(H,null,G("baudRateOpts"in h?h.baudRateOpts:l(Tt),f=>(V(),A(m,{value:f},{default:t(()=>[s(F(f===115200?`${f} (default)`:f),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(L,{label:"Data Bits",modelValue:l(u).dataBits,"onUpdate:modelValue":_[3]||(_[3]=f=>l(u).dataBits=f),placeholder:"8 (default)",interface:"popover"},{default:t(()=>[e(m,{value:8},{default:t(()=>[s("8 (default)")]),_:1}),e(m,{value:7},{default:t(()=>[s("7")]),_:1}),e(m,{value:6},{default:t(()=>[s("6")]),_:1}),e(m,{value:5},{default:t(()=>[s("5")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(L,{label:"Stop Bits",modelValue:l(u).stopBits,"onUpdate:modelValue":_[4]||(_[4]=f=>l(u).stopBits=f),placeholder:"1 (default)",interface:"popover"},{default:t(()=>[e(m,{value:1},{default:t(()=>[s("1 (default)")]),_:1}),e(m,{value:2},{default:t(()=>[s("2")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(L,{label:"Parity",modelValue:l(u).parity,"onUpdate:modelValue":_[5]||(_[5]=f=>l(u).parity=f),placeholder:"none (default)",interface:"popover"},{default:t(()=>[e(m,{value:"none"},{default:t(()=>[s("none (default)")]),_:1}),e(m,{value:"even"},{default:t(()=>[s("even")]),_:1}),e(m,{value:"mark"},{default:t(()=>[s("mark")]),_:1}),e(m,{value:"odd"},{default:t(()=>[s("odd")]),_:1}),e(m,{value:"space"},{default:t(()=>[s("space")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(T,{class:"monitor-setting-title"},{default:t(()=>[s("Receiving")]),_:1}),e(x,null,{default:t(()=>[e(L,{label:"Output Format",modelValue:l(o).outputFormat,"onUpdate:modelValue":_[6]||(_[6]=f=>l(o).outputFormat=f),placeholder:"Select the output format",interface:"popover"},{default:t(()=>[e(m,{value:"utf-8"},{default:t(()=>[s("UTF-8 (default)")]),_:1}),e(m,{value:"ascii"},{default:t(()=>[s("ASCII")]),_:1}),e(m,{value:"hex"},{default:t(()=>[s("HEX")]),_:1}),e(m,{value:"uint8"},{default:t(()=>[s("uint8")]),_:1}),e(m,{value:"binary"},{default:t(()=>[s("binary")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(L,{label:"Split message at",modelValue:l(o).splitAt,"onUpdate:modelValue":_[7]||(_[7]=f=>l(o).splitAt=f),placeholder:"Select a line terminator to use",interface:"popover"},{default:t(()=>[e(m,{value:""},{default:t(()=>[s("don't split (default)")]),_:1}),e(m,{value:"r"},{default:t(()=>[s("\\r – carriage-return")]),_:1}),e(m,{value:"n"},{default:t(()=>[s("\\n – line feed")]),_:1}),e(m,{value:"rn"},{default:t(()=>[s("\\r\\n – both")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(D,{modelValue:l(o).convertAnsi,"onUpdate:modelValue":_[8]||(_[8]=f=>l(o).convertAnsi=f)},{default:t(()=>[s(" Convert ANSI escape sequences (translates color seq.) ")]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(D,{modelValue:l(o).visualizeNewlineChars,"onUpdate:modelValue":_[9]||(_[9]=f=>l(o).visualizeNewlineChars=f)},{default:t(()=>[s(" Visualize newline characters ")]),_:1},8,["modelValue"])]),_:1}),e(T,{class:"monitor-setting-title"},{default:t(()=>[s("Sending")]),_:1}),e(x,null,{default:t(()=>[e(L,{label:"Input Format",modelValue:l(o).inputFormat,"onUpdate:modelValue":_[10]||(_[10]=f=>l(o).inputFormat=f),placeholder:"Select the input format",interface:"popover"},{default:t(()=>[e(m,{value:"text"},{default:t(()=>[s("text (default)")]),_:1}),e(m,{value:"hex"},{default:t(()=>[s("HEX")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(L,{label:"Line Terminator",modelValue:l(o).lineTerminator,"onUpdate:modelValue":_[11]||(_[11]=f=>l(o).lineTerminator=f),placeholder:"Select a line terminator to use",interface:"popover"},{default:t(()=>[e(m,{value:""},{default:t(()=>[s("none")]),_:1}),e(m,{value:"r"},{default:t(()=>[s("\\r – carriage-return")]),_:1}),e(m,{value:"n"},{default:t(()=>[s("\\n – line feed (default)")]),_:1}),e(m,{value:"rn"},{default:t(()=>[s("\\r\\n – both")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(M,null,{default:t(()=>[e($,null,{default:t(()=>[e(k,{slot:"start"},{default:t(()=>[e(y,{class:"ion-padding-start",color:"primary",fill:"solid",onClick:_[12]||(_[12]=f=>I())},{default:t(()=>[s(" Save ")]),_:1}),e(y,{color:"secondary",fill:"outline",onClick:_[13]||(_[13]=f=>d(!1))},{default:t(()=>[s(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"])],64)}}}),Et=ge($t,[["__scopeId","data-v-5cd35100"]]);var Rt={};const Mt=["value"],Bt=ae({__name:"monitorLogButton",setup(w){const{newMsgId:c,ipcSubject:p}=Te(Ve.IPC_FLASH),{$db:u}=xe(),o=E(1024),r=E(!1),d=S=>{r.value=S,S?L():m()},I=E(),h=E(""),_=Object.entries(K),O=E(K.INFO),y=qe(()=>x(R.value.filter(S=>be[S.level]<=be[O.value])));let T=null;const $=()=>Ge(()=>u.monitorLogs.limit(o.value).reverse().toArray()),R=E([]);function m(){T&&(T.unsubscribe(),T=null)}function L(){m(),T=$().subscribe({next:S=>R.value=S})}function x(S){return[...S].reverse().reduce((k,{level:M,prefix:B,msg:f,timestamp:W},Y)=>{const q=new Date(Date.parse(W)).toLocaleTimeString("de");return k+(Y===0?"":`\r
`)+`${q} [${M}]: ${B} - ${f}`},"")}Qe(R,S=>{S&&(h.value=x(S),Ke(()=>{I.value&&(I.value.scrollTop=I.value.scrollHeight)}))},{immediate:!0});async function D(){p.next({type:z.SAVE_FILE_REQUEST,id:c(),path:`${Rt.USERPROFILE}\\Documents\\serial-monitor-log-${Vt()}.txt`,content:h.value})}return ke(m),(S,k)=>{const M=se,B=ie,f=re,W=ce,Y=fe,q=ue,Q=de,n=pe,a=_e,g=me,b=Oe;return V(),N(H,null,[e(B,{onClick:k[0]||(k[0]=i=>d(!0)),fill:"clear",color:"light",title:"Open log"},{default:t(()=>[e(M,{slot:"icon-only",color:"secondary",icon:"ioniconsDocumentText"in S?S.ioniconsDocumentText:l(Xe)},null,8,["icon"])]),_:1}),e(b,{"is-open":l(r),onWillDismiss:k[4]||(k[4]=i=>d(!1))},{default:t(()=>[e(Q,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[s("Monitor Logs")]),_:1}),e(Y,{class:"log-level-option",slot:"end",label:"Level",modelValue:l(O),"onUpdate:modelValue":k[1]||(k[1]=i=>le(O)?O.value=i:null)},{default:t(()=>[(V(!0),N(H,null,G(l(_),([i,v])=>(V(),A(W,{key:v},{default:t(()=>[s(F(v),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]),e(B,{onClick:k[2]||(k[2]=i=>d(!1)),slot:"end",fill:"default"},{default:t(()=>[e(M,{icon:"ioniconsClose"in S?S.ioniconsClose:l(Ce),size:"medium"},null,8,["icon"])]),_:1})]),_:1})]),_:1}),e(n,{class:"ion-padding"},{default:t(()=>[X("textarea",{class:"logs",value:l(y),placeholder:"No log entries",readonly:"",ref_key:"textarea",ref:I},null,8,Mt)]),_:1}),e(g,null,{default:t(()=>[e(q,null,{default:t(()=>[e(a,{slot:"start"},{default:t(()=>[e(B,{class:"ion-padding-start",slot:"end",fill:"solid",color:"primary",disabled:!l(h),onClick:D},{default:t(()=>[e(M,{slot:"start",icon:"ioniconsSave"in S?S.ioniconsSave:l(Ye)},null,8,["icon"]),s(" Save to file ")]),_:1},8,["disabled"]),e(B,{fill:"solid",color:"danger",disabled:!l(h),onClick:k[3]||(k[3]=()=>l(u).monitorLogs.clear())},{default:t(()=>[e(M,{slot:"start",icon:"ioniconsTrash"in S?S.ioniconsTrash:l(Ze)},null,8,["icon"]),s(" Clear ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"])],64)}}}),Nt=ge(Bt,[["__scopeId","data-v-a1cde245"]]);var Pt=function(){function w(){this.ansi_colors=[[{rgb:[0,0,0],class_name:"ansi-black"},{rgb:[187,0,0],class_name:"ansi-red"},{rgb:[0,187,0],class_name:"ansi-green"},{rgb:[187,187,0],class_name:"ansi-yellow"},{rgb:[0,0,187],class_name:"ansi-blue"},{rgb:[187,0,187],class_name:"ansi-magenta"},{rgb:[0,187,187],class_name:"ansi-cyan"},{rgb:[255,255,255],class_name:"ansi-white"}],[{rgb:[85,85,85],class_name:"ansi-bright-black"},{rgb:[255,85,85],class_name:"ansi-bright-red"},{rgb:[0,255,0],class_name:"ansi-bright-green"},{rgb:[255,255,85],class_name:"ansi-bright-yellow"},{rgb:[85,85,255],class_name:"ansi-bright-blue"},{rgb:[255,85,255],class_name:"ansi-bright-magenta"},{rgb:[85,255,255],class_name:"ansi-bright-cyan"},{rgb:[255,255,255],class_name:"ansi-bright-white"}]],this.setup_256_palette(),this.useClasses=!1,this.escapeForHtml=!0,this.bright=!1,this.fg=this.bg=null,this._buffer=""}return Object.defineProperty(w.prototype,"useClasses",{get:function(){return this._useClasses},set:function(c){this._useClasses=c},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"escapeForHtml",{get:function(){return this._escapeForHtml},set:function(c){this._escapeForHtml=c},enumerable:!0,configurable:!0}),w.prototype.setup_256_palette=function(){var c=this;this.palette_256=[],this.ansi_colors.forEach(function(_){_.forEach(function(O){c.palette_256.push(O)})});for(var p=[0,95,135,175,215,255],u=0;u<6;++u)for(var o=0;o<6;++o)for(var r=0;r<6;++r){var d={rgb:[p[u],p[o],p[r]],class_name:"truecolor"};this.palette_256.push(d)}for(var I=8,h=0;h<24;++h,I+=10){var d={rgb:[I,I,I],class_name:"truecolor"};this.palette_256.push(d)}},w.prototype.doEscape=function(c){return c.replace(/[&<>]/gm,function(p){if(p==="&")return"&amp;";if(p==="<")return"&lt;";if(p===">")return"&gt;"})},w.prototype.old_linkify=function(c){return c.replace(/(https?:\/\/[^\s]+)/gm,function(p){return'<a href="'+p+'">'+p+"</a>"})},w.prototype.detect_incomplete_ansi=function(c){return!/.*?[\x40-\x7e]/.test(c)},w.prototype.detect_incomplete_link=function(c){for(var p=!1,u=c.length-1;u>0;u--)if(/\s|\x1B/.test(c[u])){p=!0;break}if(!p)return/(https?:\/\/[^\s]+)/.test(c)?0:-1;var o=c.substr(u+1,4);if(o.length===0)return-1;if("http".indexOf(o)===0)return u+1},w.prototype.ansi_to_html=function(c){var p=this,u=this._buffer+c;this._buffer="";var o=u.split(/\x1B\[/);o.length===1&&o.push("");var r=o[o.length-1];r.length>0&&this.detect_incomplete_ansi(r)?(this._buffer="\x1B["+r,o.pop(),o.push("")):(r.slice(-1)==="\x1B"&&(this._buffer="\x1B",console.log("raw",o),o.pop(),o.push(r.substr(0,r.length-1)),console.log(o),console.log(r)),o.length===2&&o[1]==""&&o[0].slice(-1)=="\x1B"&&(this._buffer="\x1B",r=o.shift(),o.unshift(r.substr(0,r.length-1))));var d=this.wrap_text(o.shift()),I=o.map(function(h){return p.wrap_text(p.process_ansi(h))});return d.length>0&&I.unshift(d),I.join("")},w.prototype.ansi_to_text=function(c){var p=this,u=c.split(/\x1B\[/),o=u.shift(),r=u.map(function(d){return p.process_ansi(d)});return o.length>0&&r.unshift(o),r.join("")},w.prototype.wrap_text=function(c){if(c.length===0||(this._escapeForHtml&&(c=this.doEscape(c)),!this.bright&&this.fg===null&&this.bg===null))return c;var p=[],u=[],o=this.fg,r=this.bg;o===null&&this.bright&&(o=this.ansi_colors[1][7]),this._useClasses?(o&&(o.class_name!=="truecolor"?u.push(o.class_name+"-fg"):p.push("color:rgb("+o.rgb.join(",")+")")),r&&(r.class_name!=="truecolor"?u.push(r.class_name+"-bg"):p.push("background-color:rgb("+r.rgb.join(",")+")"))):(o&&p.push("color:rgb("+o.rgb.join(",")+")"),r&&p.push("background-color:rgb("+r.rgb+")"));var d="",I="";return u.length&&(d=' class="'+u.join(" ")+'"'),p.length&&(I=' style="'+p.join(";")+'"'),"<span"+d+I+">"+c+"</span>"},w.prototype.process_ansi=function(c){this._sgr_regex||(this._sgr_regex=(m=[`
              ^                           # beginning of line
              ([!<-?]?)             # a private-mode char (!, <, =, >, ?)
              ([d;]*)                    # any digits or semicolons
              ([ -/]?               # an intermediate modifier
               [@-~])               # the command
              ([sS]*)                   # any text following this CSI sequence
              `],m.raw=[`
              ^                           # beginning of line
              ([!\\x3c-\\x3f]?)             # a private-mode char (!, <, =, >, ?)
              ([\\d;]*)                    # any digits or semicolons
              ([\\x20-\\x2f]?               # an intermediate modifier
               [\\x40-\\x7e])               # the command
              ([\\s\\S]*)                   # any text following this CSI sequence
              `],this.rgx(m)));var p=c.match(this._sgr_regex);if(!p)return c;var u=p[4];if(p[1]!==""||p[3]!=="m")return u;for(var o=p[2].split(";");o.length>0;){var r=o.shift(),d=parseInt(r,10);if(isNaN(d)||d===0)this.fg=this.bg=null,this.bright=!1;else if(d===1)this.bright=!0;else if(d===22)this.bright=!1;else if(d===39)this.fg=null;else if(d===49)this.bg=null;else if(d>=30&&d<38){var I=this.bright?1:0;this.fg=this.ansi_colors[I][d-30]}else if(d>=90&&d<98)this.fg=this.ansi_colors[1][d-90];else if(d>=40&&d<48)this.bg=this.ansi_colors[0][d-40];else if(d>=100&&d<108)this.bg=this.ansi_colors[1][d-100];else if((d===38||d===48)&&o.length>0){var h=d===38,_=o.shift();if(_==="5"&&o.length>0){var O=parseInt(o.shift(),10);O>=0&&O<=255&&(h?this.fg=this.palette_256[O]:this.bg=this.palette_256[O])}if(_==="2"&&o.length>2){var y=parseInt(o.shift(),10),T=parseInt(o.shift(),10),$=parseInt(o.shift(),10);if(y>=0&&y<=255&&T>=0&&T<=255&&$>=0&&$<=255){var R={rgb:[y,T,$],class_name:"truecolor"};h?this.fg=R:this.bg=R}}}}return u;var m},w.prototype.rgx=function(c){var p=c.raw[0],u=/^\s+|\s+\n|\s+#[\s\S]+?\n/gm,o=p.replace(u,"");return new RegExp(o,"m")},w}();const Ft=w=>(It("data-v-b8e98971"),w=w(),yt(),w),At=Ft(()=>X("div",{style:{"flex-grow":"1"}},null,-1)),Dt={class:"monitor-output-wrapper"},Ut={slot:"start",class:"monitor-output-tag"},jt=["innerHTML"],zt={key:1},Ht={key:0,class:"monitor-no-messages"},Wt={slot:"start"},qt=ae({__name:"monitor",setup(w){const c=kt(),p=Ie(),u=ye(),o=E(new Set),r=E([]),d=E(""),{newMsgId:I,ipcSubject:h}=Te(Ve.IPC_FLASH);let _=null;const O=new Set,y=E(null),T=E("");let $=!1,R=new TextEncoder,m=new Pt;const{$db:L}=xe();function x(n){switch(!0){case n==="info":return"#334155";case n==="error":return"#dc2626";case(n.startsWith("COM")&&n.length>3):return Se(n.slice(3)??0);default:return Se(n)}}function D(){_&&(_.unsubscribe(),_=null)}async function S(n){O.size===0&&await L.monitorLogs.add({level:K.INFO,prefix:"session",msg:"Started new monitoring session",timestamp:new Date().toISOString()}),f("info",`Starting monitor for ${n}...`,n);const a=I();O.add(a),h.next({type:z.START_COM_MONITOR_REQUEST,id:a,port:n,config:{...p.value}})}function k(n){f("info",`Stopping monitor for ${n}...`,n);const a=I();O.add(a),h.next({type:z.STOP_COM_MONITOR_REQUEST,id:a,port:n}),setTimeout(()=>{o.value.size===0&&L.monitorLogs.add({level:K.INFO,prefix:"session",msg:"Ended monitoring session",timestamp:new Date().toISOString()})},100)}function M(n){var a;o.value.size===0&&(n.preventDefault(),n.stopPropagation(),c.update(),(a=document.getElementById("monitor-com-port-select"))==null||a.open())}function B(n){const a=n.detail.value,g=[...o.value];g.filter(v=>!a.includes(v)).forEach(v=>{o.value.delete(v),k(v),y.value===v&&(y.value=null)}),a.filter(v=>!g.includes(v)).forEach(v=>{o.value.add(v),S(v),y.value||(y.value=v)})}function f(n,a,g,b=!1){b||r.value.push({prefix:n,msg:a,port:g,timestamp:Date.now()}),L.monitorLogs.add({level:n==="error"?K.ERROR:K.INFO,prefix:n,msg:a,port:g,timestamp:new Date().toISOString()});const i=document.querySelector(".monitor-output");if(i&&(i.scrollTop+i.clientHeight===i.scrollHeight||$)){const v=Date.now();$=v,setTimeout(()=>{i.scrollTo({top:i.scrollHeight,behavior:"smooth"}),setTimeout(()=>{$===v&&($=!1)},500)},100)}}function W(n,a){if(n&&a){let g=a.trim();const b=u.value.lineTerminator;b.includes("r")&&(g+="\r"),b.includes("n")&&(g+=`
`),u.value.inputFormat==="hex"&&(g=xt(a));const i=I();O.add(i),h.next({type:z.COM_MONITOR_SEND_DATA,id:i,port:n,data:g});const v=typeof g=="string"?g.replaceAll("\r","␍\r").replaceAll(`
`,`␊
`).replaceAll(`␍\r␊
`,`␍␊\r
`):g;u.value.visualizeNewlineChars&&(g=v),f(n,`Sending data to ${n}: ${g}`,n)}}function Y(n){return n.reduce((a,g)=>a+g.toString(2).padStart(8,"0")+" ","").trim()}function q(n,a){const g=u.value.outputFormat,b=R.encode(a);g==="ascii"?a=String.fromCharCode(...b):g==="hex"?a=Array.from(b,i=>i.toString(16).padStart(2,"0")).join(" "):g==="uint8"?a=b.join(" "):g==="binary"&&(a=Y(b)),f(n.port,a,n.port)}const Q=c.update;return Je(()=>{D(),_=h.pipe(et(n=>O.has(n.id))).subscribe({next:n=>{switch(n.type){case z.COM_MONITOR_INFO_RESPONSE:if(n.info.startsWith("Opened port ")){const b=r.value.findLastIndex(i=>i.port===n.port&&i.msg.startsWith("Starting"));r.value=r.value.map((i,v)=>v===b?{...i,msg:`${i.msg} — Opened ✓`}:i),f("info",`Port ${n.port} opened with config ${Object.keys({...p.value}).map(i=>`${i}: ${p.value[i]}`).join(", ")}`,n.port,!0)}else if(n.info.startsWith("Closed port ")){const b=r.value.findLastIndex(i=>i.port===n.port&&i.msg.startsWith("Stopping"));r.value=r.value.map((i,v)=>v===b?{...i,msg:`${i.msg} — Closed ✓`}:i),f("info",`Port ${n.port} closed`,n.port,!0)}else if(n.info.startsWith("Sent data to port ")){const b=r.value.findLastIndex(i=>i.port===n.port&&i.msg.startsWith("Sending"));r.value=r.value.map((i,v)=>v===b?{...i,msg:`${i.msg} — Sent ✓`}:i),f("info",`Sent data to port ${n.port}`,n.port,!0)}else if(n.info.startsWith("Drained port ")){const b=r.value.findLastIndex(i=>i.port===n.port&&i.msg.startsWith("Sending"));r.value=r.value.map((i,v)=>v===b?{...i,msg:`${i.msg} — Drained ✓`}:i),f("info",`Drained port ${n.port}`,n.port,!0)}else f("info",n.info,n.port);break;case z.COM_MONITOR_DATA_RESPONSE:let a;const g=u.value.lineTerminator;g==="n"&&(a=n.data.split(`
`)),g==="r"&&(a=n.data.split("\r")),g==="rn"?a=n.data.split(`\r
`):a=[n.data],a.forEach(b=>q(n,b));break;case z.ERROR_RESPONSE:throw f("error",n.reason),new Error(n.reason)}},error:n=>{console.error(n),f("error",n.message)}})}),ke(()=>{D(),o.value.forEach(k)}),(n,a)=>{const g=ot,b=_e,i=re,v=Ot,ee=ue,Le=de,U=se,J=ie,$e=lt,Ee=Et,te=at,ve=st,Z=we,j=ce,ne=fe,he=it,Re=rt,Me=ut,Be=Nt,Ne=dt,Pe=Ct,Fe=wt,Ae=ct,De=me,Ue=ft,je=pe,ze=tt;return V(),A(ze,null,{default:t(()=>[e(Le,null,{default:t(()=>[e(ee,null,{default:t(()=>[e(b,{slot:"start"},{default:t(()=>[e(g)]),_:1}),e(i,null,{default:t(()=>[s("Monitor")]),_:1}),e(b,{slot:"end"},{default:t(()=>[e(v)]),_:1})]),_:1})]),_:1}),e(je,{fullscreen:!0,class:"ion-padding"},{default:t(()=>[e(te,{class:"left-padding"},{default:t(()=>[e(ee,null,{default:t(()=>[e(U,{slot:"start",size:"large",color:"danger",icon:"ioniconsPulse"in n?n.ioniconsPulse:l(pt)},null,8,["icon"]),e(i,{class:"left-padding"},{default:t(()=>[s(" Serial Device Monitor ")]),_:1}),e($e,{class:"left-padding"},{default:t(()=>[s(F(l(c).length)+" connected serial "+F(("pluralize"in n?n.pluralize:l(Lt))(l(c).length,"device",!1))+" found ",1),e(J,{size:"small",color:"medium",style:{"margin-left":"0.5em","margin-top":"-0.5em"},onClick:a[0]||(a[0]=C=>l(Q)())},{default:t(()=>[e(U,{slot:"start",icon:"ioniconsRefresh"in n?n.ioniconsRefresh:l(_t)},null,8,["icon"]),s(" Refresh ")]),_:1})]),_:1}),e(b,{slot:"end"},{default:t(()=>[e(Ee)]),_:1})]),_:1})]),_:1}),l(c).length?oe("",!0):(V(),A(te,{key:0},{default:t(()=>[e(Z,{color:"warning",class:"monitor-no-devices ion-margin-end"},{default:t(()=>[e(U,{slot:"start",icon:"ioniconsAlert"in n?n.ioniconsAlert:l(mt)},null,8,["icon"]),e(ve,null,{default:t(()=>[s("No serial devices detected")]),_:1})]),_:1}),e(J,{color:"light",onClick:a[1]||(a[1]=C=>l(Q)())},{default:t(()=>[e(U,{slot:"start",icon:"ioniconsReload"in n?n.ioniconsReload:l(gt)},null,8,["icon"]),s(" Reload ")]),_:1})]),_:1})),e(Re,{class:"monitor-options"},{default:t(()=>[e(Z,null,{default:t(()=>[e(ne,{id:"monitor-com-port-select",label:"COM Ports",placeholder:"Select ports to monitor",interface:"popover",onIonChange:B,onClick:a[2]||(a[2]=C=>l(Q)()),multiple:!0},{default:t(()=>[(V(!0),N(H,null,G(l(c),C=>(V(),A(j,{slot:"start",value:C.path},{default:t(()=>[s(F(C.path),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1}),e(Z,null,{default:t(()=>[e(he,{label:"Filter",placeholder:"Enter filter text",debounce:200,value:l(d),onIonInput:a[3]||(a[3]=C=>d.value=C.target.value),class:"monitor-filter"},null,8,["value"])]),_:1})]),_:1}),e(Ue,null,{default:t(()=>[e(Ne,{class:"monitor-output-header"},{default:t(()=>[e(Me,null,{default:t(()=>[s("Monitor Output")]),_:1}),At,e(Be),e(J,{onClick:a[4]||(a[4]=()=>r.value=[]),fill:"clear",color:"light",title:"Clear Output"},{default:t(()=>[e(U,{slot:"icon-only",color:"medium",icon:"ioniconsBackspace"in n?n.ioniconsBackspace:l(vt)},null,8,["icon"])]),_:1})]),_:1}),X("div",Dt,[e(Ae,{class:"monitor-output"},{default:t(()=>{var C;return[(V(!0),N(H,null,G(l(r).filter(P=>!l(d)||(P.msg+P.port+P.prefix).toLowerCase().includes(l(d).toLowerCase())),P=>(V(),A(Z,null,{default:t(()=>[X("div",Ut,[e(Pe,{style:ht(`--background: ${x(P.prefix)}`)},{default:t(()=>[s(F(P.prefix),1)]),_:2},1032,["style"])]),e(ve,null,{default:t(()=>[l(u).convertAnsi?(V(),N("pre",{key:0,innerHTML:l(m).ansi_to_html(P.msg)},null,8,jt)):(V(),N("pre",zt,F(P.msg),1))]),_:2},1024),e(Fe,{slot:"end"},{default:t(()=>[X("span",null,F(new Date(P.timestamp).toLocaleTimeString("de")),1)]),_:2},1024)]),_:2},1024))),256)),(C=l(r))!=null&&C.length?oe("",!0):(V(),N("div",Ht," No output messages "))]}),_:1})]),e(De,null,{default:t(()=>[e(ee,null,{default:t(()=>[e(Z,{lines:"none"},{default:t(()=>[X("div",Wt,[e(ne,{placeholder:"Select port",interface:"popover",interfaceOptions:{header:"Select port"},modelValue:l(y),"onUpdate:modelValue":a[5]||(a[5]=C=>le(y)?y.value=C:null),onClickCapture:M},{default:t(()=>[e(U,{slot:"label",icon:"ioniconsCodeSlash"in n?n.ioniconsCodeSlash:l(bt)},null,8,["icon"]),(V(!0),N(H,null,G(l(o),C=>(V(),A(j,{value:C},{default:t(()=>[s(F(C),1)]),_:2},1032,["value"]))),256)),l(o).size===0?(V(),A(j,{key:0,disabled:""},{default:t(()=>[s(" No connected ports ")]),_:1})):oe("",!0)]),_:1},8,["modelValue"])]),e(he,{type:"text",modelValue:l(T),"onUpdate:modelValue":a[6]||(a[6]=C=>le(T)?T.value=C:null),onKeyup:a[7]||(a[7]=nt(C=>W(l(y),l(T)),["enter"])),placeholder:`Enter data to send to port (format: ${l(u).inputFormat})`},null,8,["modelValue","placeholder"]),e(te,{slot:"end",class:"ion-nowrap"},{default:t(()=>[e(ne,{placeholder:"Select line terminator",interface:"popover",interfaceOptions:{header:"Select line terminator"},modelValue:l(u).lineTerminator,"onUpdate:modelValue":a[8]||(a[8]=C=>l(u).lineTerminator=C)},{default:t(()=>[e(j,{value:""},{default:t(()=>[s("none")]),_:1}),e(j,{value:"r"},{default:t(()=>[s("\\r – CR")]),_:1}),e(j,{value:"n"},{default:t(()=>[s("\\n – LF")]),_:1}),e(j,{value:"rn"},{default:t(()=>[s("\\r\\n – CRLF")]),_:1})]),_:1},8,["modelValue"]),e(J,{class:"ion-margin-start",size:"default",disabled:!(l(y)&&l(T)),onClick:a[9]||(a[9]=C=>W(l(y),l(T)))},{default:t(()=>[e(U,{slot:"start",icon:"ioniconsSend"in n?n.ioniconsSend:l(St)},null,8,["icon"]),s(" Send ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),en=ge(qt,[["__scopeId","data-v-b8e98971"]]);export{en as default};
